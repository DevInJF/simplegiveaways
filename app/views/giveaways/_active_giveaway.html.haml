- content_for :content_header do

  .end-giveaway-button
    = link_to "<i class='icon-remove icon-white'></i> End Now".html_safe, "#", :class => "btn btn-end btn-danger btn-small", :"data-toggle" => "modal", :href => "#end_confirm"

    .modal.hide.fade{ :id => "end_confirm" }
      .modal-header
        %a.close{ :"data-dismiss" => "modal"}
          x
        %h3 End Giveaway #{giveaway.title}
      .modal-body
        = link_to "<i class='icon-remove icon-white'></i> Yes End The Giveaway Now".html_safe, end_facebook_page_giveaway_path(@page, giveaway), :class =>"btn btn-xlarge"
        %p If you want to only modify the end time of the giveaway click here to view and edit the giveaway details.

  .countdown-timer
    %p
      %span Ends in
      %span#weeks.time
      %span.text Weeks,
      %span#daysLeft.time
      %span.text Days,
      %span#hours.time
      %span.text Hours, and
      %span#minutes.time
      %span.text Minutes

%header.giveaway.active.thumbnail
  .meta
    %h1= truncate(giveaway.title, :length => 26)
    %p is #{giveaway.status}
    .dates
      %p Started on #{datetime_mdy(giveaway.start_date)}
      %p Ends on #{datetime_mdy(giveaway.end_date)}
    = link_to "<i class='icon-eye-open'></i> View Details".html_safe, facebook_page_giveaway_path(@page, giveaway), :class => "btn btn-large"
  .image= image_tag(giveaway.image(:medium))

= render 'stats', :giveaway => giveaway

= render 'entries', :giveaway => giveaway

:javascript
  $(function() {

    var currentDate = new Date();
    $('div.countdown-timer').countdown("#{giveaway.end_date.strftime("%m/%d/%Y %H:%M:%S")}", function(event) {
      var $this = $(this);
      switch(event.type) {
        case "seconds":
        case "minutes":
        case "hours":
        case "days":
        case "weeks":
        case "daysLeft":
          $this.find('span#'+event.type).html(event.value);
          break;
        case "finished":
          $this.fadeTo('slow', .5);
          break;
      }
    });

    $(".pop.views").popover({"title": "Total Views", "content": "The number of impressions the giveaway has recieved."});
    $(".pop.unique_views").popover({"title": "Unique Views", "content": "The number of people who have viewed the giveaway."});
    $(".pop.viral_views").popover({"title": "Viral Views", "content": "The number of impressions generated by Wall Posts and Requests from entrants who shared the giveaway."});
    $(".pop.viral_views").popover({"title": "Viral Views", "content": "The number of impressions generated by Wall Posts and Requests from entrants who shared the giveaway."});
    $(".pop.likes").popover({"title": "Likes", "content": "The total number of likes added to your page since the giveaway has gone live. This includes likes not specifically generated by people entering the giveaway. This stat is included because often people will like your page without wanting to grant access to the giveaway app"});
    $(".pop.likes_from_entries").popover({"title": "Likes From Entries", "content": "The number of likes added to your page from people entering the giveaway."});
    $(".pop.viral_likes").popover({"title": "Viral Likes", "content": "The number of likes added to your pages from social sharing (Wall Posts and Requests)"});
    $(".pop.entries").popover({"title": "Entries", "content": "The number of people entered to win the giveaway"});
    $(".pop.entry_rate").popover({"title": "Entry Rate", "content": "The percentage of vistors who have entered the giveaway."});
    $(".pop.viral_entries").popover({"title": "Viral Entries", "content": "Number of entries from social sharing."});
    $(".pop.shares").popover({"title": "Shares", "content": "The total number of share actions taken by entrants"});
    $(".pop.wall_posts").popover({"title": "Wall Posts", "content": "Number of entrants who have posted the giveaway on their wall"});
    $(".pop.requests").popover({"title": "Requests", "content": "Number of Requests sent by entrants to their friends. A Request is like a message sent...."});
  });
